# NoSQL 数据库&设计原则

## 学习 NoSQL 的数据有和意义?(先吹一波 NoSQL 的牛逼)

1. 易扩展, 高性能, 高可用
2. 较容易映射复杂数据(key-value)
3. 无事物特性要求(ACID 特性)
   - 原则性
   - 一致性
   - 隔离性
   - 持久性

## 数据库相关概念

`关系型数据库`, 是指采用了`关系模型`来组织数据的数据库

`NoSQL`是对不同于传统的关系数据库的 数据库管理系统的统称

## NoSQL 设计

- 常见场景及设计方法(内嵌、父子引用、反范式)

- 双向关联的场景及设计原则

## 什么是内嵌

内嵌是指 存在关联关系的文档, 放在同一文档中, 以数组的形式存放

```json
{
  "username": "junjun",
  "gender": 0,
  // roles 就是内嵌
  "roles": ["admin", "user"],
  "address": ["address1", "address2"]
}
```

1. 减少了关联查询
2. 适合于单类需要描述的属性
3. 不经常变化的属性(扩展、嵌套关联)

## 什么是父引用

父引用是指存在一对多的情况中, 放在同一文档中, 以数组的形式存放

```json
{
  "tid": "postID",
  "title": "文章标题",
  "catalog": "index",
  "created": "1609248687258",
  "comments": ["commentID1", "commentID2"]
}
```

## 什么是子引用

子引用是指存在一对非常多的情况中, 由于数据库文档存放限制, 这个时候进行反向引用

```json
{
  "cid": "commentID",
  "tid": "postID",
  "content": "这是回复的内容, 不错不错",
  "isRead": 0,
  "isBest": 0,
  "status": 1
}
```

1. 引用数据内容是否非常多
2. 引用数据量是否非常庞大, 而且在增加
3. 数据是否需要单独访问

## 什么叫做反范式

范式是指按既定的用法, 范式就是一种公认的模型或模式

用右手拿筷子, 叫范式; 过马路看红绿灯, 是一种范式; 开手动挡的车, 先踩离合挂一档, 这也是一种范式

反范式 => 不走寻常路 ~~~

```json
{
  "tid": "postID",
  "title": "文章标题",
  "created": "1609248687258",
  "users": [
    {
      "uid": "用户ID",
      "name": "用户昵称",
      "isVip": "1"
    }
  ]
}
```

[![rqpBX8.png](https://s3.ax1x.com/2020/12/29/rqpBX8.png)](https://imgchr.com/i/rqpBX8)
